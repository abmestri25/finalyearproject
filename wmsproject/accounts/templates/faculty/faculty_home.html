{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="wrapper">
  <!-- Sidebar  -->
  <nav id="sidebar">
    <div class="sidebar-header">
      <h3>WORKSHOP MANAGEMENT SYSTEM</h3>
    </div>

    <ul class="list-unstyled components">
      <div class="d-flex flex-column justify-content-center text-center ">
        <img src="{{request.user.faculty.profile_pic.url}}" class="img-fluid rounded-circle mx-auto mb-2" width="60px"
          alt="">
        <h5>{{request.user.first_name}} {{request.user.last_name}} </h5>
        <h6>FACULTY</h6>
        <ul class="list-unstyled ">
          <li>

            <button type="button" class="btn" data-toggle="modal" data-target="#staticBackdrop">
              <a href="#">Create Report
                <i class="fas fa-plus"></i>
              </a>
            </button>

          </li>
        </ul>

      </div>




      <div class="nav flex-column nav-pills text-center mt-2" id="v-pills-tab" role="tablist"
        aria-orientation="vertical">
        <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab"
          aria-controls="v-pills-home" aria-selected="true"><i class="fas fa-home"></i> Home</a>

        <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab"
          aria-controls="v-pills-settings" aria-selected="false"><i class="fas fa-building"></i> My Reports</a>
        <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab"
          aria-controls="v-pills-messages" aria-selected="false"><i class="fas fa-paper-plane"></i> Messages</a>

        <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab"
          aria-controls="v-pills-profile" aria-selected="false"><i class="fas fa-user-circle"></i> Profile</a>
      </div>

    </ul>

  </nav>

  <!-- Page Content  -->
  <div id="content">

{% comment %} 
 <div class="row d-flex justify-content-end">

{% for field in form.visible_fields %}
      {% for error in field.errors %}
      
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
        <strong>{{ field.label_tag }}</strong><span style=" color:red"> {{ error }}</span>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% endfor %}
      {% endfor %}
    </div> {% endcomment %}

{% comment %} 
{% for field in form.visible_fields %}
      {% for error in field.errors %}
  <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 200px;">
  <div class="toast" style="position: absolute; top: 0; right: 0;">
    <div class="toast-header">
      <img src="..." class="rounded mr-2" alt="...">
      <strong class="mr-auto">{{request.user}}</strong>
      <small>11 min ago</small>
      <button type="button" class="btn-close" data-dismiss="toast" aria-label="Close"></button>
    </div>
    <div class="toast-body">
    {{ error }}
    </div>
  </div>
</div>
{% endfor %}
{% endfor %} {% endcomment %}


    <nav class="navbar navbar-expand-lg " style="background-color: #7386D5;">
      <div class="container-fluid">

        <button type="button" id="sidebarCollapse" class="btn text-light bg-dark btn-info">
          <i class="fas fa-align-left"></i>
        </button>

        <a href="{% url 'logout' %}">
          <button type="button" class="btn btn-danger">
            <i class="fas fa-power-off"></i>
          </button>
        </a>



      </div>
    </nav>

   



    <div class="line"></div>


    <div class="tab-content" id="v-pills-tabContent">
      <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
        <section class="mt-3">
          <div class="container-fluid d-flex justify-content-around">
            <div class="card" style="width: 18rem;">
              <div class="card-body">
                <h5 class="card-title">Total Reports</h5>
                <h6 class="card-subtitle mb-2 text-muted">23</h6>

              </div>
            </div>
            <div class="card" style="width: 18rem;">
              <div class="card-body">
                <h5 class="card-title">Workshops</h5>
                <h6 class="card-subtitle mb-2 text-muted">15</h6>

              </div>
            </div>
            <div class="card" style="width: 18rem;">
              <div class="card-body">
                <h5 class="card-title">Seminars</h5>
                <h6 class="card-subtitle mb-2 text-muted">15</h6>

              </div>
            </div>
            <div class="card" style="width: 18rem;">
              <div class="card-body">
                <h5 class="card-title">Pending Reports</h5>
                <h6 class="card-subtitle mb-2 text-muted">15</h6>

              </div>
            </div>
          </div>

        </section>

        <div class="line"></div>
        <div class="row">
          <div class="col-md-6">
            <div class="d-flex justify-content-between py-2">
              <h3>Recent Reports</h3>
              <button class="btn btn-sm">View All</button>

            </div>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Title</th>
                    <th scope="col">Faculty</th>
                    <th scope="col">Created At</th>
                  </tr>
                </thead>
                <tbody>
                {% for report in reports %}
                 <tr>
                    <th scope="row">{{forloop.counter}}</th>
                    <td>{{report.event_title}}</td>
                    <td>{{report.event_coordinator}}</td>
                    <td>{{report.created_at}}</td>
                  </tr>
                {% endfor %}
                 
    
                </tbody>
              </table>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex justify-content-between py-2">
              <h3>Pending Reports</h3>
              <button class="btn btn-sm">View All</button>

            </div>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Title</th>
                    <th scope="col">Faculty</th>
                    <th scope="col">Created At</th>
                  </tr>
                </thead>
                <tbody>
                {% for report in pending_reports %}
                 <tr>
                    <th scope="row">{{forloop.counter}}</th>
                    <td>{{report.event_title}}</td>
                    <td>{{report.event_coordinator}}</td>
                    <td>{{report.created_at}}</td>
                  </tr>
                {% endfor %}
                 
    
                </tbody>
              </table>
            </div>
          </div>

        </div>


        <div class="row">
          <div class="col-md-12">
            <div class="d-flex justify-content-between py-2">
              <h3>All Faculties</h3>
              <button class="btn btn-sm">View All</button>

            </div>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">First Name</th>
                    <th scope="col">Middle Name</th>
                    <th scope="col">Last Name</th>
                    <th scope="col">Email</th>
                    <th scope="col">Mobile Number</th>
                    <th scope="col">Department</th>
                    <th scope="col">Qualification</th>
                    <th scope="col">Joined At</th>

                  </tr>
                </thead>
                <tbody>
                  {% for faculty in faculties %}
                  <tr>
                    <th scope="row"> {{forloop.counter}} </th>
                    <td>{{faculty.user.first_name}}</td>
                    <td>{{faculty.middle_name}}</td>
                    <td>{{faculty.user.last_name}}</td>
                    <td>{{faculty.user.email}}</td>
                    <td>{{faculty.phone_number}}</td>
                    <td>{{faculty.branch}}</td>
                    <td>{{faculty.qualification}}</td>
                    <td>{{faculty.joined_at}}</td>
                  </tr>
                  {% endfor %}

                </tbody>
              </table>
            </div>
          </div>


        </div>


       
      </div>
      <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">
      
      <div class="row">
          <div class="col-md-12">
            <div class="d-flex justify-content-between py-2">
              <h3>All Reports</h3>
              <button class="btn btn-sm">View All</button>

            </div>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Academic Year</th>
                    <th scope="col">Report Title</th>
                    <th scope="col">Resource Person</th>
                    <th scope="col">Profile Pic</th>
                    <th scope="col">Faculty</th>
                    <th scope="col">For Whome</th>
                    <th scope="col">Type</th>
                    <th scope="col">Department</th>
                    <th scope="col">Starts At</th>
                    <th scope="col">End At</th>
                    <th scope="col">Status</th>
                    <th scope="col">Delete</th>

                  </tr>
                </thead>
                <tbody>
                  {% for report in my_reports %}
                  <tr>
                    <th scope="row"> {{forloop.counter}} </th>
                    <td>{{report.academic_year}}</td>
                    <td>{{report.event_title}}</td>
                    <td>{{report.res_person}}</td>
                    <td><img src="{{report.res_person_profile_pic.url}}" alt="pp" width="37" height="37"
                        class="rounded mr-3" loading="lazy">
                    </td>
                    <td>{{report.event_coordinator}}</td>
                    <td>{{report.forwhome}}</td>
                    <td>{{report.types}}</td>
                    <td>{{report.org_department}}</td>
                    <td>{{report.start_date}}</td>
                    <td>{{report.end_date}}</td>
                    <td>
                    {% if report.status == 0 %}
                      <button class="btn btn-sm btn-warning" disabled="disabled" data-toggle="modal" data-target="#reply_modal">Not Yet Approved</button>

                                {% comment %} <a href="{% url 'student_approve_report' report_id=report.id %}" class="btn btn-success" >Approve</a>
                                <a class="btn btn-danger" href="{% url 'student_disapprove_report' report_id=report.id %}" >Disapprove</a> {% endcomment %}
                    {% elif report.status == 1  %}
                      <button class="btn btn-sm btn-success" disabled="disabled" data-toggle="modal" data-target="#reply_modal">Approved</button>
                    {% else %}
                      <a class="btn btn-sm btn-danger"  data-toggle="modal" data-target="#reply_modal">Resend</button>
                    {% endif %}
                    
                    </td>
                    <td>
                    <button class="btn btn-sm btn-danger">Delete</button>
                    </td>
                  </tr>
                  {% endfor %}

                </tbody>
              </table>
            </div>
          </div>


        </div>

      </div>
      <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">Profile
      </div>
      <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">

        <div class="row">
          <div class="col-md-12">
            <div class="d-flex justify-content-between py-2">
              <h3>Task Assigned</h3>
              {% comment %} <button class="btn btn-sm">View All</button> {% endcomment %}

            </div>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Title</th>
                  <th scope="col">Faculty</th>
                  <th scope="col">Type</th>
                  <th scope="col">For Whome</th>
                  <th scope="col">Department</th>
                  <th scope="col">Resource Person</th>
                  <th scope="col">Created at</th>
                  <th scope="col">Remove</th>

                </tr>
              </thead>
              <tbody>
                {% for task in my_tasks %}
                <tr>
                  <th scope="row"> {{forloop.counter}} </th>
                  <td>{{task.event_title}}</td>
                  <td>{{task.event_coordinator}}</td>
                  <td>{{task.types}}</td>
                  <td>{{task.forwhome}}</td>
                  <td>{{task.org_department}}</td>
                  <td>{{task.res_person}}</td>
                  <td>{{task.created_at}}</td>

                  <td><button type="button" class="btn btn-sm btn-danger" data-toggle="modal"
                      data-target="#staticBackdrop2">
                      Delete
                    </button></td>
                </tr>
                {% endfor %}

              </tbody>
            </table>
          </div>


        </div>

      </div>
      
    </div>




    <div class="line"></div>


  </div>



  <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Create a Report</h5>
          <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form method="POST" class="row g-3">
            {% csrf_token %}

            <div class="col-12">
              <label for="inputAddress" class="form-label">Title</label>
              {{form.event_title}}
              
            </div>
            <div class="col-md-4">
              <label for="inputCity" class="form-label">Type</label>
              {{form.types}}
            </div>


            <div class="col-md-4">
              <label for="inputCity" class="form-label">For Whome</label>
              {{form.forwhome}}
            </div>
            <div class="col-md-4">
              <label for="inputCity" class="form-label">Duration</label>
              <input type="number" name="duration" class="form-control">
            </div>
            <div class="col-md-4">
              <label for="inputPassword4" class="form-label">Department</label>
              {{form.org_department}}
            </div>
            <div class="col-md-4">
              <label for="inputPassword4" class="form-label">Academic Year</label>
              <input type="number" name="academic_year" class="form-control">

            </div>

            <div class="col-md-4">
              <label for="inputPassword4" class="form-label">Faculty</label>
              {{form.event_coordinator}}
            </div>
            <div class="col-md-6">
              <label for="inputAddress2" class="form-label">Resource Person</label>
              {{form.res_person}}

            </div>
            <div class="col-md-6">
              <label for="inputCity" class="form-label">Profile Pic</label>
              {{form.res_person_profile_pic}}
            </div>
            <div class="col-md-4">
              <label for="inputCity" class="form-label">No Of Participants</label>
              <input type="number" name="no_participants" class="form-control">

            </div>
            <div class="col-md-8">
              <label for="inputCity" class="form-label">Remark</label>
              {{form.remark}}
            </div>
            <div class="col-md-6">
              <label for="inputCity" class="form-label">Start Date</label>
              <input type="date" name="start_date" class="form-control" id="">
            </div>
            <div class="col-md-6">
              <label for="inputCity" class="form-label">End Date</label>
              <input type="date" name="end_date" class="form-control">
            </div>
            <div class="col-md-12">
              <label for="inputCity" class="form-label">Google Drive Link</label>
              {{form.p_link}}
            </div>

            <div class="col-md-12">
              <label for="inputCity" class="form-label">Description</label>
              {{form.description}}
            </div>






        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="submit" id="createreport" class="btn btn-primary">Create Report</button>
        </div>
        {% if messages %}
        <div class="col-md-12">
          {% for message in messages %}
          {% if message.tags == 'error' %}
          <div class="alert alert-danger" style="margin-top:10px">{{ message }}</div>
          {% endif %}
          {% if message.tags == 'success' %}
          <div class="alert alert-success" style="margin-top:10px">{{ message }}</div>
          {% endif %}
          {% endfor %}
        </div>
        {% endif %}
        </form>
      </div>
    </div>
  </div>
</div>


<script>

$("#createreport").click(function(){
  swal({
    title : "Report Created !",
    text : "Wait for approval",
    icon : "success",
    button : "OK"
  })
})
</script>

{% endblock content %}